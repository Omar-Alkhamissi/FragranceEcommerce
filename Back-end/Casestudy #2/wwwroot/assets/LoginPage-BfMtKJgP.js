import{Q as g}from"./QAvatar-DOYIPmmt.js";import{Q as m}from"./QInput-Cc4Z8OYg.js";import{Q as u}from"./QBtn-CHXcyl-P.js";import{Q as f}from"./QForm-BpnZXmhH.js";import{Q as q,p as x}from"./apiutil-D8HAWs6d.js";import{O as y,q as v,x as i,t as o,s as d,y as w,a2 as _,Q,S as V,ad as S,f as b}from"./index-DFsSz3xY.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-key-composition-DgtSb1yN.js";import"./focus-manager-8kG1G93H.js";const F={setup(){const n=V(),t=S();let s=b({status:"",email:"",password:""});return{state:s,login:async()=>{s.status="logging in with server";let r={email:s.email,password:s.password};try{let a=await x("customer/login",r);console.log("Full payload received from server:",a),a.token&&!a.token.includes("invalid")&&!a.token.includes("failed")?(sessionStorage.setItem("customer",JSON.stringify(a)),console.log("Stored in sessionStorage:",JSON.stringify(a)),s.status="login successful",t.query.nextUrl?n.push({path:t.query.nextUrl}):n.push({path:"/"})):s.status=a.token}catch(a){s.status=a.message}},isRequired:r=>!!r||"field is required",isValidEmail:r=>/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/.test(r)||"Invalid email",resetFields:()=>{s.email="",s.password="",s.status=""}}}},k={class:"text-center"};function z(n,t,s,e,p,c){return v(),y(Q,null,[i("div",k,[o(g,{square:"",class:"q-mb-md logo-avatar"},{default:d(()=>t[2]||(t[2]=[i("img",{src:"/img/Spade.png"},null,-1)])),_:1,__:[2]})]),t[3]||(t[3]=i("div",{class:"text-h4 text-center q-mt-md q-mb-md text-primary"},"Login",-1)),i("div",{class:_(["text-title2 text-center text-bold q-mt-sm",e.state.status.includes("successful")?"text-positive":"text-negative"])},w(e.state.status),3),o(q,{class:"q-ma-md q-pa-md"},{default:d(()=>[o(f,{ref:"myForm",class:"q-gutter-md",greedy:"",onSubmit:e.login,onReset:e.resetFields},{default:d(()=>[o(m,{outlined:"",placeholder:"Email",id:"email",modelValue:e.state.email,"onUpdate:modelValue":t[0]||(t[0]=l=>e.state.email=l),rules:[e.isRequired,e.isValidEmail]},null,8,["modelValue","rules"]),o(m,{outlined:"",placeholder:"Password",id:"password",modelValue:e.state.password,"onUpdate:modelValue":t[1]||(t[1]=l=>e.state.password=l),type:"password",rules:[e.isRequired]},null,8,["modelValue","rules"]),o(u,{label:"Login",type:"submit"}),o(u,{label:"Reset",type:"reset"})]),_:1},8,["onSubmit","onReset"])]),_:1})],64)}const C=R(F,[["render",z],["__scopeId","data-v-ab7a10d5"]]);export{C as default};
